/* slava naumenko (c) - https://github.com/menu4web/sp-elements */ if(!window.SPe){var SPe={version:"7.17",Ajax:{},Cookie:{},Date:{},Form:{},List:{},Query:{},Rest:{},Tabs:{},Util:{},init:function(){SPe.nop=function(){};SPe.has=function(a,c){return-1<a.indexOf(c)};SPe.path=function(a){return SPe.has(window.location.href,a)};SPe.url=function(){var a=_spPageContextInfo;return a.webServerRelativeUrl||a._web.serverRelativeUrl};SPe.hide=function(a){a.style.display="none"};SPe.show=function(a){a.style.display=""};SPe.type=function(a){return((Object.prototype.toString.call(a).match(/^\[object\s(\S+?)\]$/)||[])[1]||"undefined").toLowerCase()};SPe.Ajax.object=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};SPe.Ajax.get=function(a,c,b){var d=SPe.Ajax.object();d.open("GET",a,!0);d.send(null);d.onreadystatechange=function(){SPe.Ajax.data(d,c,b)}};SPe.Ajax.post=function(a,c,b,d,e){var f=SPe.Ajax.object();f.open("POST",a,!0);b?Object.keys(b).forEach(function(g){f.setRequestHeader(g,b[g])}):f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.send(c);f.onreadystatechange=function(){SPe.Ajax.data(f,d,e)}};SPe.Ajax.data=function(a,c,b){c=c||SPe.nop;b=b||SPe.Ajax.error;if(4===a.readyState){var d=a.status;!d||200<=d&&300>d||304===d||1223===d?c(a.responseText):b(d)}};SPe.Ajax.error=function(a){console.warn("Request failed. Status: "+a+".")};SPe.Cookie.set=function(a,c,b){var d=new Date;d.setTime(d.getTime()+864E5*b);b="expires="+d.toGMTString();document.cookie=a+"="+c+"; "+b+"; path=/"};SPe.Cookie.get=function(a){a+="=";var c=document.cookie.split(";"),b;for(b=0;b<c.length;b++){var d=c[b].trim();if(0===d.indexOf(a)){var e=d.substring(a.length,d.length);e=e.replace(/&\s/g,"\uff06 ");break}}return e};SPe.Date.masks={shortDate:"M/d/yyyy",shortDateTime:"M/d/yyyy h:mm TT",isoDate:"yyyy-MM-dd",isoDateTime:"yyyy-MM-dd'T'HH:mm:ss"};SPe.Date.fromString=function(a,c){function b(n){return n.replace(/-/g,"/").replace(/\./g,"/").replace(/T/g," ")}function d(n){var m=n.indexOf(" ");-1===m&&(m=n.length);return m}function e(n,m){var p=-1,q;for(q=0;q<n.length;q++)if(SPe.has(n[q],m)){p=q;break}return p}c=SPe.Date.masks[c]||c||SPe.Date.masks.shortDateTime;c=b(c);var f=d(c),g=c.substring(f),h=c.substring(0,f).split("/");f=e(h,"y");var l=e(h,"M");h=e(h,"d");a=b(a);var k=d(a);g=g?a.substring(k):"";k=a.substring(0,k).split("/");return new Date(k[l]+"/"+k[h]+"/"+k[f]+g)};SPe.Date.compareToToday=function(a,c,b){function d(f){return f.setHours(0,0,0,0)}b=b||0;"string"===SPe.type(a)&&(a=SPe.Date.fromString(a));var e=new Date;e.setDate(e.getDate()+b);b=!1;switch(c){case "<":a<e&&(b=!0);break;case "<=":d(a)<=d(e)&&(b=!0);break;case "==":d(a)===d(e)&&(b=!0);break;case ">=":d(a)>=d(e)&&(b=!0);break;case ">":a>e&&(b=!0)}return b};SPe.Date.format=function(a,c,b){"string"===SPe.type(a)&&(a=SPe.Date.fromString(a));c=SPe.Date.masks[c]||c||SPe.Date.masks.shortDate;var d=a.getDate(),e=a.getMonth()+1,f=a.getFullYear(),g=a.getHours(),h=a.getMinutes(),l=a.getSeconds(),k=12>g,n=g%12||12,m=a.toLocaleString("en-US",{month:"long"}).replace(/-/g," "),p=m.split(",").length-1;0!==p&&(2===p&&(m=m.substring(m.indexOf(",")+2)),m=m.substring(0,m.indexOf(" ")));var q={d:d,dd:SPe.Util.pad(d),M:e,MM:SPe.Util.pad(e),MMM:m.substring(0,3),MMMM:m,yy:f.toString().slice(2),yyyy:f,h:n,hh:SPe.Util.pad(n),H:g,HH:SPe.Util.pad(g),m:h,mm:SPe.Util.pad(h),s:l,ss:SPe.Util.pad(l),t:k?"a":"p",tt:k?"am":"pm",T:k?"A":"P",TT:k?"AM":"PM"};c=c.replace(/d{1,2}|M{1,4}|y{2,4}|([HhmsTt]){1,2}|"[^"]*"|'[^']*'/g,function(r){return q.hasOwnProperty(r)?q[r]:r.slice(1,r.length-1)});b&&(SPe.has(b.toString(),"#")||(b="#ff0000"),SPe.Date.compareToToday(a,"<")&&(c="<font color='"+b+"'>"+c+"</font>"));return c};SPe.Date.addDays=function(a,c){var b=new Date(a);return new Date(b.setDate(b.getDate()+c))};SPe.Date.addBusinessDays=function(a,c,b){function d(g){e=SPe.Date.addDays(g,1);g=e.getDay();0===g||6===g||SPe.has(b,SPe.Date.format(e))||f++;f<c&&d(e);return e}b=b||[];var e,f=0;return d(a)};SPe.Form.get=function(a){a=a||window;return a.document.getElementById("part1")||a.document.getElementById("formTbl")||SPe.Form.elGetByClass(document,"div","od-Panel--md")||SPe.Form.elGetByClass(document,"div","od-ListForm-fullPage")||SPe.Form.elGetByClass(document,"div","list-form-container-root")||SPe.Form.elGetByClass(document,"div","Files-rightPaneContent")};SPe.Form.tblGet=function(a){return SPe.Form.elGetByClass(a,"table","ms-formtable")||SPe.Form.elGetByClass(a,"table")};SPe.Form.elGet=function(a,c,b,d){var e=null;a=a.getElementsByTagName(c);for(c=0;c<a.length;c++)if(SPe.has(a[c].id,b)&&(!d||SPe.has(a[c].title,d))){e=a[c];break}return e};SPe.Form.elGetByClass=function(a,c,b){var d=null;a=a.getElementsByTagName(c);for(c=0;c<a.length;c++)if(!b||SPe.has(a[c].className,b)){d=a[c];break}return d};SPe.Form.elGetByText=function(a,c,b){var d=null;a=a.getElementsByTagName(c);for(c=a.length-1;0<=c;c--)if(!b||SPe.has(a[c].parentNode.innerHTML,b)){d=a[c];break}return d};SPe.Form.elGetByAttribute=function(a,c,b,d){var e=null;a=a.getElementsByTagName(c);var f;for(c=0;c<a.length;c++)if((f=a[c].getAttribute(b))&&SPe.has(f,d)){e=a[c];break}return e};SPe.Form.elGetParent=function(a,c,b){var d=null;for(c=c.toLowerCase();a.parentNode;)if(a=a.parentNode,a.tagName&&a.tagName.toLowerCase()===c&&(!b||SPe.has(a.parentNode.innerHTML,b))){d=a;break}return d};SPe.Form.elVisible=function(a,c){if(void 0===c||!0===c)c="";!1===c&&(c="none");(SPe.Form.elGetParent(a,"tr")||SPe.Form.elGetParent(a,"div","clientFormField")).style.display=c};SPe.Form.elHide=function(a){SPe.Form.elVisible(a,!1)};SPe.Form.elShow=function(a){SPe.Form.elVisible(a,!0)};SPe.Form.elMinimize=function(a){function c(e){d.innerHTML="<a href='#'>&#187; Show the field</a>";SPe.hide(e)}var b=SPe.Form.elGetParent(a,"td"),d=document.createElement("div");b.insertBefore(d,b.firstChild);d.onclick=function(){"none"===a.style.display?(d.innerHTML="<a href='#'>&#171; Hide the field</a><br><br>",SPe.show(a)):c(a)};c(a)};SPe.Form.elRewrite=function(a,c){var b;"text"===a.type&&(b="text");"textarea"===a.type&&(b="textarea");"select-one"===a.type&&(b="select");SPe.has(a.id,"DateTimeFieldDate")&&(b="date");if(SPe.has(a.id,"ClientPeoplePicker")||SPe.has(a.className,"pickerInput"))b="user";SPe.has(a.id,"MultiChoiceTable")&&(b="checkboxes");SPe.has(a.className,"taxonomy")&&(b="taxonomy");var d="";switch(b){case "text":var e=a;d=e.value;break;case "textarea":e=a;d=SPe.Form.textGroom(e.value);break;case "select":e=a;SPe.has(e.toString(),"Select")&&(d=e.options[e.selectedIndex].text);break;case "date":e=SPe.Form.elGetParent(a,"table");d=a.value;break;case "user":e=a.parentNode;if(b=SPe.Form.elGet(e,"input","HiddenInput")){var f=JSON.parse(b.value);f.forEach(function(g){d+=", "+g.DisplayText})}else for(e=SPe.Form.elGetParent(a,"div","ReactFieldEditor-Picker"),b=SPe.Form.elGetParent(e,"div","clientFormField"),f=b.querySelectorAll("div.ms-Persona-primaryText"),b=0;b<f.length;b++)d+=", "+f[b].innerText;d=d.substring(2);break;case "checkboxes":e=a;f=e.getElementsByTagName("span");for(b=0;b<f.length;b++)SPe.has(f[b].innerHTML.toLowerCase(),"checked")&&(d+=", "+f[b].title);d=d.substring(2);break;case "taxonomy":e=a,b=SPe.Form.elGet(SPe.Form.elGetParent(e,"td"),"input","input"),d=b.value,d=d.substring(0,d.indexOf("|"))}void 0!==c&&(d=c);b=SPe.Form.elGetParent(e,"td")||SPe.Form.elGetParent(e,"div");f=b.firstChild;"span"===f.nodeName.toLowerCase()&&b.removeChild(f);SPe.hide(e);(e=SPe.Form.elGetByClass(b,"span","ms-metadata"))&&SPe.hide(e);e=document.createElement("span");SPe.has(SPe.type(b),"div")&&(e.style.padding="6px 12px 1px 12px",e.style.fontSize="14px");e.innerHTML=d;b.insertBefore(e,b.firstChild)};SPe.Form.setField=function(a,c){var b=document.createEvent("Event");b.initEvent("input",!0,!0);a.focus();a.value=c;a.dispatchEvent(b);a.blur()};SPe.Form.setPersonField=function(a,c){SPe.Util.wait(function(){function b(){return document.querySelector("button.ms-Suggestions-itemButton")}SPe.Form.setField(a,c);a.focus();SPe.Util.when(function(){return document.querySelector("div.ms-Persona-primaryText")&&b()},function(){b().click();a.blur()})},300)};SPe.Form.preSaveTextareas=[];SPe.Form.textareaReplace=function(a,c){if(!SPe.has(SPe.Form.preSaveTextareas,a)){SPe.Form.preSaveTextareas.push(a);SPe.hide(a.parentNode);var b=SPe.Form.elGetParent(a,"td")||SPe.Form.elGetParent(a,"div","wrapper"),d=document.createElement("span"),e="string"===SPe.type(c);d.innerHTML=e?c:c.innerHTML;e||c.parentNode.removeChild(c);d=b.insertBefore(d,b.firstChild);if(a.value){if(SPe.has(d.innerHTML,"rowDuplicate"))for(b=a.value.split("\n"),d=SPe.Form.elGetByText(d,"input")||SPe.Form.elGetByText(d,"select"),e=0;e<b.length;e++)SPe.Form.rowDuplicate(d,b.length);SPe.Form.textareaValues(a)}window.PreSaveAction=window.PreSaveAction||SPe.Form.preSaveValues}};SPe.Form.textareaValues=function(a){function c(n,m){var p,q=m.split(",");for(p=0;p<q.length;p++)SPe.Form.userSet(SPe.Form.elGet(n,"div","TopSpan"),q[p],!1)}if(a.value){var b=a.value.split("\n"),d=0;a=SPe.Form.elGetParent(a,"td")||SPe.Form.elGetParent(a,"div","wrapper");a=SPe.Form.elGetByClass(a,"table");var e,f;for(e=0;e<a.rows.length;e++){var g=a.rows[e];var h=g.innerHTML;if(b[d]&&(SPe.has(h,"input")||SPe.has(h,"select"))){var l=b[d].split(";");d++;for(h=0;h<g.cells.length;h++){var k=g.cells[h];if(k=SPe.Form.elGetByText(k,"input")||SPe.Form.elGetByText(k,"select")||SPe.Form.elGetByText(k,"div"))(f="htmldivelement"===SPe.type(k))||SPe.has(k.className,"peoplepicker")?(f||(k=SPe.Form.elGetParent(k,"div")),setTimeout(c.bind(null,k,l[h]),400)):k.value=l[h]}}}}};SPe.Form.preSaveValues=function(){function a(c){var b="";c&&(JSON.parse(c).forEach(function(d){b+=","+d.EntityData.Email}),b=b.substring(1));return b}SPe.Form.preSaveTextareas.forEach(function(c){var b=SPe.Form.elGetParent(c,"td")||SPe.Form.elGetParent(c,"div","wrapper"),d="",e=SPe.Form.elGetByClass(b,"table");for(b=0;b<e.rows.length;b++){var f=e.rows[b];var g=f.innerHTML;if(SPe.has(g,"input")||SPe.has(g,"select"))for(d+="\n",g=0;g<f.cells.length;g++){var h=f.cells[g];if(h=SPe.Form.elGetByText(h,"input")||SPe.Form.elGetByText(h,"select"))h=SPe.has(h.className,"peoplepicker")?a(SPe.Form.elGet(SPe.Form.elGetParent(h,"div"),"input","HiddenInput").value):h.value.trim().replace(";",","),d+=h+";"}}if(d=d.replace(/\n;+/g,""))d=d.substring(1),SPe.Form.setField(c,d)});return!0};SPe.Form.rowDuplicate=function(a,c){c=c||5;var b=SPe.Form.elGetParent(a,"table"),d=SPe.Form.elGetParent(a,"tr");b.rows.length<=c&&(b.insertRow(-1).innerHTML=d.innerHTML)};SPe.Form.choicesGroom=function(a){a.style.width="100%";var c;for(c=0;c<a.rows.length;c++){var b=a.rows[c].cells[0].childNodes[0];var d=b.childNodes[0];b=b.childNodes[1];d.style.cssFloat="left";d.style.marginRight="5px";b.style.display="block"}};SPe.Form.optionsSave=function(a){var c=[],b;for(b=0;b<a.length;b++)a[b].value&&c.push({text:a[b].text,value:a[b].value,selected:a[b].selected});return c};SPe.Form.optionsShow=function(a,c,b){var d=SPe.Form.optionsSave(a);a.length=0;if(b){var e=document.createElement("option");e.value="";e.text="";a.add(e)}d.forEach(function(f,g){if(!c||SPe.has(c,f.value)||SPe.has(c,g))e=document.createElement("option"),e.value=f.value,e.text=f.text,a.add(e),f.selected&&!b&&(a.options[a.length-1].selected=!0)})};SPe.Form.rowsVisible=function(a,c,b){if(void 0===b||!0===b)b="";!1===b&&(b="none");c=SPe.Util.rangeToArray(c);var d;for(d=0;d<a.rows.length;d++)SPe.has(c,d)&&(a.rows[d].style.display=b)};SPe.Form.headerAdd=function(a,c,b){void 0===b&&(b=!0);a.style.marginTop="0";var d=a.insertRow(0);d.className="form-header";var e="";b&&(e="<style>.ms-dialog .form-header { display: none }</style>");b=d.insertCell(0);b.colSpan=a.rows[1].cells.length;b.style.paddingBottom="14px";b.innerHTML=e+"<div class='ms-rteFontSize-4'></div>";a=SPe.Form.elGetByClass(b,"div","ms-rteFontSize-4");c&&(a.innerHTML=c);return a};SPe.Form.rowAdd=function(a,c,b){a=SPe.Form.elGetParent(a,"tr");a=a.parentNode.insertRow(a.rowIndex).insertCell(0);a.colSpan=2;b&&(a.style.backgroundColor=b);a.innerHTML=c;return a};SPe.Form.divAdd=function(a,c,b){var d=SPe.Form.elGetParent(a,"div","ReactClientFormFields"),e=document.createElement("div");b&&(e.style.backgroundColor=b);e.innerHTML=c;d.insertBefore(e,SPe.Form.elGetParent(a,"div","clientFormField"));return e};SPe.Form.selectSet=function(a,c){var b;for(b=0;100>b;b++)if(a.options[b].value===c){a.options[b].selected=!0;break}};SPe.Form.taxonomySet=function(a,c){var b=c.Label||c.get_label(),d=c.TermGuid||c.get_termGuid(),e=SPe.Form.elGetParent(a,"td"),f=SPe.Form.elGet(e,"input","input")||SPe.Form.elGet(e,"input","ctl");SPe.Form.elGet(e,"div","editableRegion").innerHTML="<span class='valid-text' title=''>"+b+"</span>;&nbsp;<span id='ms-rterangecursor-start'></span><span id='ms-rterangecursor-end'></span>";f.value=b+"|"+d};SPe.Form.taxonomyEmpty=function(a){a=SPe.Form.elGetParent(a,"td");var c=SPe.Form.elGet(a,"input","input")||SPe.Form.elGet(a,"input","ctl");SPe.Form.elGet(a,"div","editableRegion").innerHTML="";c.value=""};SPe.Form.taxonomyMonitor=function(a,c){var b=SPe.Form.elGetParent(a,"td"),d=SPe.Form.elGet(b,"input","input")||SPe.Form.elGet(b,"input","ctl");b=SPe.Form.elGet(b,"div","editableRegion");var e=d.value;SPe.Form.elMonitor(b,function(){var f=d.value;f&&!SPe.has(f,"-0000-0000-0000-")&&f!==e&&(e=f,c(f))})};SPe.Form.textLinkify=function(a){var c="";a&&(c=a.replace(/([^"])((http|https|ftp|file):\/\/[A-Z0-9_\-+#\/.]+[A-Z0-9_\-+&@#\/%?=~|!:,;]+)/gi,"$1<a href=$2>$2</a>"),c=c.replace(/([^\/])(www\.[A-Z0-9_\-+#\/.]+[A-Z0-9_\-+&@#\/%?=~|!:,;]+)/gi,"$1<a href=http://$2>$2</a>"),c=c.replace(/([A-Z0-9_'\-.]+@[A-Z0-9_\-.]+\.[A-Z]{2,4})/gi,"<a href=mailto:$1>$1</a>"));return c};SPe.Form.textBreakify=function(a){var c="";a&&(c=a.replace(/(?:\r\n|\r|\n)/g,"<br> "));return c};SPe.Form.textBreaksClean=function(a){var c="";a&&(c=a.replace(/(<br>\s+)/gi,"<br>"),c=c.replace(/(<br><br>(<br>)+)/gi,"<br><br>"));return c};SPe.Form.textGroom=function(a){return SPe.Form.textBreaksClean(SPe.Form.textLinkify(SPe.Form.textBreakify(a)))};SPe.Form.commentsGroom=function(a,c){c=c||"border-top: 1px solid #cdcdcd";var b=SPe.Form.elGetParent(a,"td","SPFieldNote");b=(b&&b.id?"":"<div><br></div>")+a.innerHTML.replace(/<\/div>/g,"</div><div><br></div>").replace(/>\):/g,">):<div style='"+c+"'><br></div>");a.innerHTML=SPe.Form.textGroom(b)};SPe.Form.userSet=function(a,c,b){void 0===b&&(b=!0);a=SPe.Form.elGetParent(a,"td");var d=SPe.Form.elGet(a,"div","UserField");if(d){var e=d.innerHTML.toLowerCase();b&&""!==e&&"&nbsp;"!==e||(d.innerHTML=c,SPe.Form.elGet(a,"a","checkNames").click())}else if(d=SPe.Form.elGet(a,"input","HiddenInput"),!b||d&&""===d.value){SPe.Form.elGet(a,"input","EditorInput").value=c;c=window;if(!c.SPClientPeoplePicker)for(b=0;b<window.frames.length;b++)if(window.frames[b].SPClientPeoplePicker){c=window.frames[b];break}a=SPe.Form.elGet(a,"div","ClientPeoplePicker")||SPe.Form.elGet(a,"div","TopSpan");c.SPClientPeoplePicker.SPClientPeoplePickerDict[a.id].AddUnresolvedUserFromEditor(!0)}};SPe.Form.userEmpty=function(a){a=SPe.Form.elGetParent(a,"td");var c=SPe.Form.elGet(a,"div","UserField");if(c)c.innerHTML="";else{c=SPe.Form.elGet(a,"input","HiddenInput");a=SPe.Form.elGet(a,"div","ClientPeoplePicker")||SPe.Form.elGet(a,"div","TopSpan");var b=SPClientPeoplePicker.SPClientPeoplePickerDict[a.id],d=b.GetAllUserInfo();d.forEach(function(e){b.DeleteProcessedUser(d[e])});c.value=""}};SPe.Form.userMonitor=function(a,c){var b=SPe.Form.elGetParent(a,"td"),d=SPe.Form.elGet(b,"div","UserField");if(d){var e=SPe.Form.elGet(b,"input","hiddenSpanData");var f=SPe.Form.elGet(b,"span","errorLabel")}else e=SPe.Form.elGet(b,"input","HiddenInput"),d=SPe.Form.elGet(b,"div","ClientPeoplePicker");var g=function(l){var k="";if(l&&"&#160;"!==l&&!SPe.has(l,"&nbsp;")){var n;if(SPe.has(l,"spani")&&!f.innerHTML){var m=document.createElement("span");m.innerHTML=l;m=m.getElementsByTagName("span");var p;for(p=0;p<m.length;p++)(n=m[p].title)&&(k+=";"+n)}SPe.has(l,"[")&&((f=SPe.Form.elGetByClass(b,"span","errorMsg"))||JSON.parse(l).forEach(function(q){(n=SPe.Util.propertyValue(q,"Description"))&&(k+=";"+n)}));k=k.substring(1)}return k},h=g(e.value);SPe.Form.elMonitor(d,function(){var l=g(e.value);l&&l!==h&&(h=l,c(l))})};SPe.Form.dialogHandler=function(a){var c=SPe.Form.elGet(document,"div","s4-workspace");c&&(c.style.overflow="hidden");a&&a();window.SP&&SP.SOD.executeOrDelayUntilScriptLoaded(function(){var b=SP.UI.ModalDialog.get_childDialog();b&&b.autoSize()},"SP.UI.Dialog.js")};SPe.Form.dialogRefreshPage=function(a){SP.UI.ModalDialog.RefreshPage(a)};SPe.Form.paramGet=function(a){var c=document.URL,b=null;if(SPe.has(c,"?")&&SPe.has(c,a+"=")){c=c.split("?")[1].split("&");var d;for(d=0;d<c.length;d++){var e=c[d].split("=");e[0]===a&&(b=decodeURIComponent(e[1]))}}return b};SPe.Form.paramRemove=function(a){var c=document.URL,b=c;if(SPe.has(c,"?")&&SPe.has(c,a+"=")){b=c.split("?")[0];c=c.split("?")[1].split("&");var d;for(d=c.length-1;0<=d;d--){var e=c[d].split("=")[0];e===a&&c.splice(d,1)}c.length&&(b+="?"+c.join("&"))}return b};SPe.Form.preSaveFields=[];SPe.Form.elValidate=function(a){if(!SPe.has(SPe.Form.preSaveFields,a)){SPe.Form.preSaveFields.push(a);var c=SPe.Form.elGetParent(a,"tr").cells[0].childNodes[0];SPe.has(a.title,"Required")||(a.title+=" Required Field");SPe.has(c.innerHTML,"required")||(c.innerHTML+="<span title='This is a required field.' class='ms-accentText'> *</span>");window.PreSaveAction=window.PreSaveAction||SPe.Form.preSaveValidation}};SPe.Form.preSaveValidation=function(){var a=!0;SPe.Form.preSaveFields.forEach(function(c){var b=SPe.Form.elGetByClass(c.parentNode,"span","ms-formvalidation");c.value?b&&SPe.hide(b.parentNode):(b?SPe.show(b.parentNode):(b=document.createElement("span"),b.innerHTML="<span class='ms-formvalidation ms-csrformvalidation'><span role='alert'>You can't leave this blank.<br></span></span>",c.parentNode.appendChild(b)),a=!1)});return a};SPe.Form.elMonitor=function(a,c){a.addEventListener("DOMSubtreeModified",c,!1)};SPe.Form.callout=function(a){SP.SOD.registerSod("Callout.js","/_layouts/15/Callout.js");SP.SOD.loadMultiple(["Callout.js"],function(){CalloutManager.createNew(a)})};SPe.Form.datePicker=function(a){SP.SOD.registerSod("Datepicker.js","/_layouts/15/Datepicker.js");SP.SOD.loadMultiple(["Datepicker.js"],function(){var c=a+"_";document.getElementById(a).innerHTML="<table id='"+c+"TopTable' border='0' cellspacing='0' cellpadding='0'><tbody><tr><td class='ms-dtinput'><label style='display: none'>Date Picker</label><input title='Date Picker' class='ms-input' id='"+c+"' type='text' maxlength='45' value='' autopostback='0'></td><td class='ms-dtinput'><a role='button' onclick=\"clickDatePicker('"+c+"', '/_layouts/15/iframe.aspx?date=', '', event); return false;\" href='#'><img id='"+c+"DatePickerImage' alt='Select a date from the calendar.' src='/_layouts/15/images/calendar_25.gif?rev=23' border='0'></a></td><td><iframe id='"+c+"DatePickerFrame' src='/_layouts/15/iframe.aspx?date=' frameborder='0' scrolling='no' style='left: 0; top: -999px; width: 200px; height: 236px; display: none; position: absolute; z-index: 101;'></iframe></td></tr></tbody></table>"})};SPe.Form.taxonomyPicker=function(a,c,b,d){d=d||{IsMulti:!0,AllowFillIn:!1,IsSpanTermSets:!1,IsSpanTermStores:!1,IsIgnoreFormatting:!1,IsIncludeDeprecated:!1,IsIncludeUnavailable:!1,IsIncludeTermSetName:!1,IsAddTerms:!1,IsIncludePathData:!1,IsUseCommaAsDelimiter:!1,Disable:!1,ExcludeKeyword:!1,JavascriptOnValidation:"",DisplayPickerButton:!0,Lcid:1033};var e=a+"_input",f=a+"_picker";document.getElementById(a).innerHTML="<link rel='stylesheet' type='text/css' href='_layouts/15/1033/styles/WebTaggingUI.css' /><input name='"+e+"' type='hidden' id='"+e+"' /><div id='"+f+"' class='ms-taxonomy ms-taxonomy-height ms-taxonomy-width'></div>";SP.SOD.registerSod("SP.Taxonomy.js","/_layouts/15/SP.Taxonomy.js");SP.SOD.registerSod("SP.UI.Rte.js","/_layouts/15/SP.UI.Rte.js");SP.SOD.registerSod("ScriptForWebTaggingUI.js","/_layouts/15/ScriptForWebTaggingUI.js");SP.SOD.registerSod("ScriptResources.resx","/_layouts/15/ScriptResx.ashx?culture=en-us&name=ScriptResources");SP.SOD.loadMultiple(["SP.js"],function(){SP.SOD.loadMultiple(["SP.Taxonomy.js","SP.UI.Rte.js","ScriptResources.resx"],function(){var g=document.getElementById(f);g.InputFieldId=e;g.SspId=c;g.TermSetId=b;g.AnchorId="00000000-0000-0000-0000-000000000000";g.FieldName="";g.FieldId="00000000-0000-0000-0000-000000000000";g.WebServiceUrl=SPe.url()+"/_vti_bin/TaxonomyInternalService.json";SPe.Util.augment(g,d);SP.SOD.executeFunc("ScriptForWebTaggingUI.js","Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.taggingLoad",function(){Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.resetEventsRegistered()});SP.SOD.executeFunc("ScriptForWebTaggingUI.js","Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.onLoad",function(){Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.onLoad(g.id)})})})};SPe.Form.peoplePicker=function(a,c){c=c||{PrincipalAccountType:"User,DL,SecGroup,SPGroup",SearchPrincipalSource:15,ResolvePrincipalSource:15,AllowMultipleValues:!0,MaximumEntitySuggestions:50,Width:"383px"};SP.SOD.registerSod("ClientTemplates.js","/_layouts/15/ClientTemplates.js");SP.SOD.registerSod("ClientForms.js","/_layouts/15/ClientForms.js");SP.SOD.registerSod("ClientPeoplePicker.js","/_layouts/15/ClientPeoplePicker.js");SP.SOD.registerSod("AutoFill.js","/_layouts/15/AutoFill.js");SP.SOD.loadMultiple(["ClientTemplates.js","ClientForms.js","ClientPeoplePicker.js","AutoFill.js"],function(){SPClientPeoplePicker_InitStandaloneControlWrapper(a,null,c)})};SPe.Form.peoplePickerValues=function(a){var c=[],b;for(b=0;b<a.length;b++)c.push(SP.FieldUserValue.fromUser(a[b].Key));return c};SPe.Form.lookupValues=function(a){var c="";if(a){var b=[];a.length?b=a:b[0]=a;for(a=0;a<b.length;a++)c+=", "+b[a].get_lookupValue();c=c.substring(2)}return c};SPe.Form.ready=function(a){var c=window;if(!SPe.Form.get(c)){var b;for(b=0;b<window.frames.length;b++)if(SPe.Form.get(window.frames[b])){c=window.frames[b];break}}c.addEventListener("load",function(){SPe.Query.ready(a)},!1)};SPe.Form.hide=function(a){SPe.Util.when(a,function(){var c=a();SPe.hide(c)})};SPe.Form.buttonHide=function(a){SPe.Form.hide(function(){var c=SPe.Form.elGetByText(document,"i",a);c&&(c=SPe.Form.elGetParent(c,"button"));return c})};SPe.Form.observe=function(a,c){function b(){return c?c():document.querySelector("div.od-panel-md-listform")||document.querySelector("div.Files-hostContainer")}SPe.Util.when(b,function(){(new MutationObserver(function(d){d.forEach(function(e){SPe.has(e.target.className,"od-ListForm-topBar")&&SPe.Util.wait(function(){a()})})})).observe(b(),{attributes:!1,childList:!0,subtree:!0})})};SPe.List.listen=!0;SPe.List.customizer=function(a){SPe.List.listen&&SPe.Util.wait(function(){function c(k,n){var m=k.getAttribute("data-item-key");m&&m===n&&(d.push(m),e[m]=a[n])}function b(k,n){k.addEventListener("DOMCharacterDataModified",function(){n(k)})}SPe.List.listen=!1;var d=[],e={},f=document.querySelector("div.ms-DetailsList-headerWrapper");if(f){f=f.querySelectorAll("div.ms-DetailsHeader-cell");var g,h;for(g=0;g<f.length;g++)for(h in a)a.hasOwnProperty(h)&&c(f[g],h)}if(h=document.querySelector("div.ms-List-page"))for(h=h.querySelectorAll("div.ms-DetailsRow-cell"),f=0;f<h.length;f++){g=h[f];var l=g.getAttribute("data-automation-key");SPe.has(d,l)&&(g=g.querySelector("div.od-FieldRenderer-text"),l=e[l],l(g),b(g,l))}SPe.List.listen=!0})};SPe.List.observe=function(a){function c(){SPe.List.customizer(a)}function b(){return document.querySelector("div.ms-List-page")}SPe.Util.when(b,function(){SPe.List.customizer(a);var d=b();d.removeEventListener("DOMNodeInserted",c);d.addEventListener("DOMNodeInserted",c)})};SPe.Query.ready=function(a){SP.SOD.executeOrDelayUntilScriptLoaded(a,"SP.js")};SPe.Query.failed=function(a,c){console.warn("Query failed. "+a.get_webRequest().get_url()+". "+c.get_message())};SPe.Query.context=function(){return SP.ClientContext.get_current()};SPe.Query.url=function(){return SPe.Query.context().get_url()};SPe.Query.items=function(a,c,b){var d=SPe.Query.context(),e=new SP.CamlQuery;e.set_viewXml(c);var f=d.get_web().get_lists().getByTitle(a).getItems(e);d.load(f);d.executeQueryAsync(function(){b(f)},SPe.Query.failed)};SPe.Query.succeeded=function(a,c){for(var b=a.getEnumerator(),d;b.moveNext();)d=b.get_current().get_fieldValues(),c(d)};SPe.Query.forEach=function(a,c,b){SPe.Query.items(a,c,function(d){SPe.Query.succeeded(d,b)})};SPe.Query.itemById=function(a,c,b){var d=SPe.Query.context(),e=d.get_web().get_lists().getByTitle(a).getItemById(c);d.load(e);d.executeQueryAsync(function(){b(e)},SPe.Query.failed)};SPe.Query.currentUserInit=function(a){var c=SPe.Query.context(),b=c.get_web().get_currentUser();c.load(b);c.executeQueryAsync(function(){SPe.Form.userSet(a,b.get_loginName(),!0)},SPe.Query.failed)};SPe.Query.currentUser=function(a){var c=SPe.Query.context(),b=c.get_web().get_currentUser();c.load(b);c.executeQueryAsync(function(){a(b)},SPe.Query.failed)};SPe.Query.userById=function(a,c){var b=SPe.Query.context(),d=b.get_web().get_siteUsers().getById(a);b.load(d);b.executeQueryAsync(function(){c(d)},SPe.Query.failed)};SPe.Query.userProfile=function(a,c,b){SP.SOD.registerSod("SP.UserProfiles.js","/_layouts/15/SP.UserProfiles.js");SP.SOD.registerSodDep("SP.UserProfiles.js","SP.Runtime.js");SP.SOD.loadMultiple(["SP.UserProfiles.js","SP.Runtime.js"],function(){var d=SPe.Query.context(),e=new SP.UserProfiles.PeopleManager(d);switch(a){case "user":var f=e.getPropertiesFor(c);break;case "current":f=e.getMyProperties()}d.load(f);d.executeQueryAsync(function(){b(f)},SPe.Query.failed)})};SPe.Query.userProperties=function(a,c){SPe.Query.userProfile("user",a,c)};SPe.Query.currentUserProperties=function(a){SPe.Query.userProfile("current","",a)};SPe.Query.userMembership=function(a,c){for(var b=!1,d=c.get_users().getEnumerator(),e;d.moveNext();)if(e=d.get_current(),e.get_id()===a.get_id()){b=!0;break}return b};SPe.Query.userGroup=function(a,c,b,d){var e=SPe.Query.context();switch(a){case "user":var f=e.get_web().get_siteUsers().getByLoginName(c);break;case "current":f=e.get_web().get_currentUser()}e.load(f);a=e.get_web().get_siteGroups();e.load(a);var g=a.getByName(b);e.load(g);b=g.get_users();e.load(b);e.executeQueryAsync(function(){d(SPe.Query.userMembership(f,g))},SPe.Query.failed)};SPe.Query.userInGroup=function(a,c,b){SPe.Query.userGroup("user",a,c,b)};SPe.Query.currentUserInGroup=function(a,c){SPe.Query.userGroup("current","",a,c)};SPe.Rest.digest=function(a){var c=SPe.url()+"/_api/ContextInfo";SPe.Ajax.post(c,"",SPe.Rest.headers("json"),function(b){b=JSON.parse(b);b=SPe.Util.propertyValue(b,"FormDigestValue");a(b)})};SPe.Rest.headers=function(a){var c={};if(!a||SPe.has(a,"json"))c.Accept="application/json;odata=verbose",c["Content-Type"]="application/json;odata=verbose";if(!a||SPe.has(a,"digest"))c["X-RequestDigest"]=_spPageContextInfo.formDigestValue||document.getElementById("__REQUESTDIGEST").value;return c};SPe.Rest.currentUserProperties=function(a){var c=SPe.url()+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties";SPe.Rest.digest(function(b){var d=SPe.Rest.headers("json");d["X-RequestDigest"]=b;SPe.Ajax.post(c,"",d,function(e){e=JSON.parse(e);a(e)})})};SPe.Rest.createFolder=function(a,c){var b=SPe.url()+"/_api/web/Folders",d=JSON.stringify({__metadata:{type:"SP.Folder"},ServerRelativeUrl:a});SPe.Ajax.post(b,d,SPe.Rest.headers(),c)};SPe.Rest.addAttachments=function(a,c,b,d){function e(){if(b[f]){var g=b[f][0],h=b[f][1];g=g.substring(g.lastIndexOf("/"))||g;g=SPe.url()+"/_api/web/lists/getbytitle('"+a+"')/items("+c+")/AttachmentFiles/add(FileName='"+g+"')";SPe.Ajax.post(g,h,SPe.Rest.headers("digest"),function(){f++;e()})}else d()}var f=0;e()};SPe.Tabs.set=[];SPe.Tabs.add=function(a,c,b,d){d=d||function(){SPe.Form.dialogHandler()};var e=SPe.Tabs.set.push({})-1,f=SPe.Tabs.set[e],g=SPe.Form.elGetParent(a,"table","ms-formtable")||SPe.Form.elGetParent(a,"div","ReactClientFormFields");f.home=g;f.t=SPe.has(SPe.type(g),"table");f.cells=c;f.callback=d;c=f.t?{table:"border-spacing: 0 7px",td:"cursor: pointer; font-size: 110%; font-weight: bold; color: #5d5b5e; padding: 5px 20px; border-bottom: 1px solid transparent; border-top: 3px solid transparent; white-space: nowrap",bg:"#f2f2f2",color:"#508ee6",div:"width: 4px"}:{table:"border-spacing: 0 12px",td:"cursor: pointer; font-size: 100%; color: #333333; padding: 4px 18px; border-bottom: 1px solid transparent; border-top: 3px solid transparent; white-space: nowrap",bg:"#f4f4f4",color:"#0078d4",div:"width: 4px"};f.style=b||c;b=SPe.Tabs.render(e);f.t?SPe.Form.rowAdd(a,b):SPe.Form.divAdd(a,b);SPe.Tabs.listen(e);a=SPe.Form.elGet(g,"table","tabs_"+e).rows[0].cells;a[a.length-1].style.width="90%";SPe.Tabs.click(a[1])};SPe.Tabs.render=function(a){var c=SPe.Tabs.set[a],b=c.style,d="";d+="<table id='tabs_"+a+"' cellspacing='0' cellpadding='0' width='100%' style='"+b.table+"'><tbody><tr>";d+="<td style='border-bottom: 1px solid "+b.color+"'><div style='"+b.div+"'></div>";c.cells.forEach(function(e,f){d+="<td id='tab_"+(a+"-"+f)+"' style='"+b.td+"'>"+e[0]+"</td>";d+="<td style='border-bottom: 1px solid "+b.color+"'><div style='"+b.div+"'></div>"});return d+="</tr></tbody></table>"};SPe.Tabs.listen=function(a){function c(e){e.addEventListener("click",function(){SPe.Tabs.click(this)})}a="tabs_"+a;a=(document.getElementById(a)||document.getElementById("formFrame").contentWindow.document.getElementById(a)).getElementsByTagName("td");var b;for(b=0;b<a.length;b++){var d=a[b];d.id&&c(d)}};SPe.Tabs.click=function(a){var c=a.id,b=c.substring(c.indexOf("_")+1,c.indexOf("-")),d=c.substring(c.indexOf("-")+1);b=SPe.Tabs.set[b];var e=b.style.bg,f=b.style.color,g="1px solid "+f,h=SPe.Form.elGetParent(a,"table").rows[0].cells,l;for(l=0;l<h.length;l++){var k=h[l];SPe.has(k.id,"tab")&&(k.id===c?(k.style.backgroundColor="transparent",k.style.borderTopColor=f,k.style.borderLeft=g,k.style.borderRight=g,k.style.borderBottom="none"):(k.style.backgroundColor=e,k.style.borderTopColor="transparent",k.style.borderLeft="none",k.style.borderRight="none",k.style.borderBottom=g))}c=SPe.Util.rangeToArray(b.cells[d][1]);d=b.t?b.home.rows:b.home.children;for(e=0;e<d.length;e++)d[e]&&(SPe.has(c,e)?SPe.show(d[e]):SPe.hide(d[e]));b.callback(a)};SPe.Tabs.go=!0;SPe.Tabs.msgMonitor=function(a,c){a.forEach(function(b){var d=SPe.Form.elGetParent(b,"td")||SPe.Form.elGetParent(b,"div","clientFormField"),e=SPe.Form.elGetParent(b,"table")||SPe.Form.elGetParent(b,"div","ReactClientFormFields");SPe.Form.elMonitor(d,function(){SPe.has(d.innerHTML,"blank")&&SPe.Tabs.go&&(SPe.Tabs.go=!1,SPe.Tabs.click(SPe.Form.elGet(e,"td",c)),setTimeout(function(){SPe.Tabs.go=!0},99))})})};SPe.Util.augment=function(a,c){Object.keys(c).forEach(function(b){a[b]=c[b]})};SPe.Util.round=function(a,c){void 0===c&&(c=2);return Number(Math.round(a+"e"+c)+"e-"+c)};SPe.Util.pad=function(a,c,b){c=c||2;b=b||"0";for(a=a.toString();a.length<c;)a=b+a;return a};SPe.Util.rangeToArray=function(a){var c=[];a.forEach(function(b){var d=b.toString().indexOf("-");if(-1===d)c.push(parseInt(b));else{var e=parseInt(b.substring(0,d));for(b=parseInt(b.substring(d+1));e<=b;e++)c.push(e)}});return c};SPe.Util.collectionToArray=function(a){var c=[],b;for(b=0;b<a.get_count();b++)c.push(a.itemAt(b));return c};SPe.Util.sort=function(a,c,b){var d=1,e=-1;b&&(d=-1,e=1);return a.sort(function(f,g){var h=0,l=SPe.Util.propertyValue(f,c),k=SPe.Util.propertyValue(g,c);l<k&&(h=d);l>k&&(h=e);return h})};SPe.Util.flip=function(a,c){var b={};c=c||"";Object.keys(a).forEach(function(d){b[c+a[d]]=d});return b};SPe.Util.clone=function(a){if("array"===SPe.type(a))var c=a.slice();else c={},Object.keys(a).forEach(function(b){var d=a[b];c[b]="object"===SPe.type(d)?SPe.Util.clone(d):d});return c};SPe.Util.propertyValue=function(a,c){function b(e,f){var g,h;for(g in e)if(e.hasOwnProperty(g)){var l=e[g];if("object"===SPe.type(l))null!==d||l.get_web||b(l,f);else if("array"===SPe.type(l))for(h=0;h<l.length;h++)null===d&&b(l[h],f);else if(e.Key===f||g===f){d=e.Value;void 0===d&&(d=l);break}}return d}var d=null;return b(a,c)};SPe.Util.xmlParse=function(a){a=a.replace(/&\s/g,"\uff06 ");if(window.DOMParser)var c=(new DOMParser).parseFromString(a,"text/xml");else c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(a);return c};SPe.Util.tagContent=function(a,c){var b=null,d=a.getElementsByTagName(c);d.length||(d=a.getElementsByTagName("d:"+c));d.length&&(b=d[0].textContent);return b};SPe.Util.xmlProperties=function(a){var c=[];a=SPe.Util.xmlParse(a).getElementsByTagName("content");var b,d,e;for(b=0;b<a.length;b++){c[b]={};var f=a[b];for(d=0;d<f.childNodes.length;d++){var g=f.childNodes[d];if(SPe.has(g.nodeName,"properties"))for(e=0;e<g.childNodes.length;e++){var h=g.childNodes[e];1===h.nodeType&&(c[b][h.localName]=h.textContent)}}}return c};SPe.Util.code=function(a){return a.split("").reduce(function(c,b){return(c<<5)-c+b.charCodeAt(0)|0},0)};SPe.Util.fun=function(a){return(a.name||SPe.Util.code(a.toString())).toString()};SPe.Util.timeout=[];SPe.Util.wait=function(a,c){c=c||99;var b=SPe.Util.fun(a);clearTimeout(SPe.Util.timeout[b]);SPe.Util.timeout[b]=setTimeout(a,c)};SPe.Util.when=function(a,c){function b(){setTimeout(function(){var e=!0;if("array"===SPe.type(a)){var f,g;for(f=0;f<a.length;f++){var h=a[f].split(".");for(g=0;g<h.length;g++)var l=g?l[h[g]]:window[h[g]];if(void 0===l){e=!1;break}}}else a()||(e=!1);e?c():99>d&&(d++,b())},99)}var d=0;b()};SPe.Util["do"]=function(a){SPe.Util.when([a],function(){var c=a.split("."),b;for(b=0;b<c.length;b++)var d=b?d[c[b]]:window[c[b]];Object.defineProperty(d,"name",{value:a,writable:!1});SPe.Util.wait(d)})};SPe.Util.htmlDecode=function(a){var c=document.createElement("textarea");c.innerHTML=a;return c.value};SPe.Util.urlDecode=function(a){a=a.replace(/\\u002f/gi,"/");a=a.replace(/\\u0025/gi,"%");return a=a.replace(/\\u0026/gi,"&")};SPe.Util.navigateUrl=function(a){a=a.substring(a.indexOf("navigateParent(")+16);a=a.substring(0,a.indexOf(");")-1);return SPe.Util.urlDecode(a)};SPe.Util.csv=function(a,c){var b="",d;for(d=0;d<c.length;d++){var e,f=c[d],g="";for(e=0;e<f.length;e++){var h=(h=f[e])||0===h?"date"===SPe.type(h)?h.toLocaleString():h.toString():"";h=h.replace(/"/g,'""');-1<h.search(/("|,|\n)/g)&&(h='"'+h+'"');g+=","+h}e=g.substring(1)+"\n";b+=e}b=new Blob([b],{type:"text/csv;charset=utf-8"});navigator.msSaveBlob?navigator.msSaveBlob(b,a):(d=document.createElement("a"),b=URL.createObjectURL(b),d.setAttribute("href",b),d.setAttribute("download",a),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d))};SPe.Util.writeTable=function(a,c){var b,d=a.rows[0].cells.length;for(b=a.rows.length-1;0<b;b--)a.deleteRow(b);var e,f=c.length;for(b=0;b<f;b++){var g=a.insertRow(-1);g.style.verticalAlign="top";for(e=0;e<d;e++)g.insertCell(e).innerHTML=c[b][e]}f||(g=a.insertRow(1),b=g.insertCell(0),b.colSpan=d,b.innerHTML="<font color='#a59e9c'>No entries found.</font>")};SPe.Util.toTitleCase=function(a){return a.replace(/\b\w+/g,function(c){return c.charAt(0).toUpperCase()+c.substr(1).toLowerCase()})};SPe.Util.enter=function(a){document.onkeydown=function(c){c=c||window.event;13===(c.which||c.keyCode)&&a()}};SPe.Util.load=function(a){a.forEach(function(c){c=c.replace("~site",SPe.url());if(SPe.has(c.toLowerCase(),".css")){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c;document.head.appendChild(b)}else b=document.createElement("script"),b.type="text/javascript",b.src=c,document.body.appendChild(b)})};SPe.Util.colorCode=function(a,c){var b=function(d){return SPe.has(a,d)};b=b("Submitted")?"#007497":b("Verified")||b("Processed")?"#6b399d":b("Approved")||b("Succeeded")?"#249324":b("Rejected")||b("Failed")?"#e60000":b("Returned")||b("Partial")?"#bf0000":b("Completed")||b("Executed")||b("Closed")?"#476d4c":b("Draft")||b("Cancelled")||b("Deferred")?"#8c8c8c":"";return c&&b?b:b?"<span style='color: "+b+"'>"+a+"</span>":""}}};SPe.init()};