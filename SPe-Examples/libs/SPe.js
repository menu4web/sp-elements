/* slava naumenko (c) - https://github.com/menu4web/sp-elements */ if(!window.SPe){var SPe={version:"7.11",Ajax:{},Cookie:{},Date:{},Form:{},List:{},Query:{},Rest:{},Tabs:{},Task:{},Util:{},init:function(){SPe.nop=function(){};SPe.has=function(a,b){return-1<a.indexOf(b)};SPe.path=function(a){return SPe.has(_spPageContextInfo.serverRequestPath,a)};SPe.url=function(a){return _spPageContextInfo.webServerRelativeUrl};SPe.hide=function(a){a.style.display="none"};SPe.show=function(a){a.style.display=""};SPe.type=function(a){return((Object.prototype.toString.call(a).match(/^\[object\s(\S+?)\]$/)||[])[1]||"undefined").toLowerCase()};SPe.Ajax.object=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};SPe.Ajax.get=function(a,b,c){var d=SPe.Ajax.object();d.open("GET",a,!0);d.send(null);d.onreadystatechange=function(){SPe.Ajax.data(d,b,c)}};SPe.Ajax.post=function(a,b,c,d,e){var f=SPe.Ajax.object();f.open("POST",a,!0);c?Object.keys(c).forEach(function(a){f.setRequestHeader(a,c[a])}):f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.send(b);f.onreadystatechange=function(){SPe.Ajax.data(f,d,e)}};SPe.Ajax.data=function(a,b,c){b=b||SPe.nop;c=c||SPe.Ajax.error;if(4===a.readyState){var d=a.status;!d||200<=d&&300>d||304===d||1223===d?b(a.responseText):c(d)}};SPe.Ajax.error=function(a){console.warn("Request failed. Status: "+a+".")};SPe.Cookie.set=function(a,b,c){var d=new Date;d.setTime(d.getTime()+864E5*c);c="expires="+d.toGMTString();document.cookie=a+"="+b+"; "+c+"; path=/"};SPe.Cookie.get=function(a){a+="=";var b=document.cookie.split(";"),c;for(c=0;c<b.length;c++){var d=b[c].trim();if(0===d.indexOf(a)){var e=d.substring(a.length,d.length);e=e.replace(/&\s/g,"\uff06 ");break}}return e};SPe.Date.masks={shortDate:"M/d/yyyy",shortDateTime:"M/d/yyyy h:mm TT",isoDate:"yyyy-MM-dd",isoDateTime:"yyyy-MM-dd'T'HH:mm:ss"};SPe.Date.fromString=function(a,b){function c(a){return a.replace(/-/g,"/").replace(/\./g,"/").replace(/T/g," ")}function d(a){var b=a.indexOf(" ");-1===b&&(b=a.length);return b}function e(a,b){var c=-1,d;for(d=0;d<a.length;d++)if(SPe.has(a[d],b)){c=d;break}return c}b=SPe.Date.masks[b]||b||SPe.Date.masks.shortDateTime;b=c(b);var f=d(b),g=b.substring(f),h=b.substring(0,f).split("/");f=e(h,"y");var l=e(h,"M");h=e(h,"d");a=c(a);var k=d(a);g=g?a.substring(k):"";k=a.substring(0,k).split("/");return new Date(k[l]+"/"+k[h]+"/"+k[f]+g)};SPe.Date.compareToToday=function(a,b,c){function d(a){return a.setHours(0,0,0,0)}c=c||0;"string"===SPe.type(a)&&(a=SPe.Date.fromString(a));var e=new Date;e.setDate(e.getDate()+c);c=!1;switch(b){case "<":a<e&&(c=!0);break;case "<=":d(a)<=d(e)&&(c=!0);break;case "==":d(a)===d(e)&&(c=!0);break;case ">=":d(a)>=d(e)&&(c=!0);break;case ">":a>e&&(c=!0)}return c};SPe.Date.format=function(a,b,c){"string"===SPe.type(a)&&(a=SPe.Date.fromString(a));b=SPe.Date.masks[b]||b||SPe.Date.masks.shortDate;var d=a.getDate(),e=a.getMonth()+1,f=a.getFullYear(),g=a.getHours(),h=a.getMinutes(),l=a.getSeconds(),k=12>g,n=g%12||12,m=a.toLocaleString("en-US",{month:"long"}).replace(/-/g," "),p=m.split(",").length-1;0!==p&&(2===p&&(m=m.substring(m.indexOf(",")+2)),m=m.substring(0,m.indexOf(" ")));var q={d:d,dd:SPe.Util.pad(d),M:e,MM:SPe.Util.pad(e),MMM:m.substring(0,3),MMMM:m,yy:f.toString().slice(2),yyyy:f,h:n,hh:SPe.Util.pad(n),H:g,HH:SPe.Util.pad(g),m:h,mm:SPe.Util.pad(h),s:l,ss:SPe.Util.pad(l),t:k?"a":"p",tt:k?"am":"pm",T:k?"A":"P",TT:k?"AM":"PM"};b=b.replace(/d{1,2}|M{1,4}|y{2,4}|([HhmsTt]){1,2}|"[^"]*"|'[^']*'/g,function(a){return q.hasOwnProperty(a)?q[a]:a.slice(1,a.length-1)});c&&(SPe.has(c.toString(),"#")||(c="#ff0000"),SPe.Date.compareToToday(a,"<")&&(b="<font color='"+c+"'>"+b+"</font>"));return b};SPe.Date.addDays=function(a,b){var c=new Date(a);return new Date(c.setDate(c.getDate()+b))};SPe.Date.addBusinessDays=function(a,b,c){function d(a){e=SPe.Date.addDays(a,1);a=e.getDay();0===a||6===a||SPe.has(c,SPe.Date.format(e))||f++;f<b&&d(e);return e}c=c||[];var e,f=0;return d(a)};SPe.Form.get=function(a){a=a||window;return a.document.getElementById("part1")||a.document.getElementById("formTbl")||SPe.Form.elGetByClass(document,"div","od-Panel--md")||SPe.Form.elGetByClass(document,"div","od-ListForm-fullPage")};SPe.Form.tblGet=function(a){return SPe.Form.elGetByClass(a,"table","ms-formtable")||SPe.Form.elGetByClass(a,"table")};SPe.Form.elGet=function(a,b,c,d){var e=null;a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)if(SPe.has(a[b].id,c)&&(!d||SPe.has(a[b].title,d))){e=a[b];break}return e};SPe.Form.elGetByClass=function(a,b,c){var d=null;a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)if(!c||SPe.has(a[b].className,c)){d=a[b];break}return d};SPe.Form.elGetByText=function(a,b,c){var d=null;a=a.getElementsByTagName(b);for(b=a.length-1;0<=b;b--)if(!c||SPe.has(a[b].parentNode.innerHTML,c)){d=a[b];break}return d};SPe.Form.elGetParent=function(a,b,c){var d=null;for(b=b.toLowerCase();a.parentNode;)if(a=a.parentNode,a.tagName&&a.tagName.toLowerCase()===b&&(!c||SPe.has(a.parentNode.innerHTML,c))){d=a;break}return d};SPe.Form.elVisible=function(a,b){if(void 0===b||!0===b)b="";!1===b&&(b="none");(SPe.Form.elGetParent(a,"tr")||SPe.Form.elGetParent(a,"div","clientFormField")).style.display=b};SPe.Form.elHide=function(a){SPe.Form.elVisible(a,!1)};SPe.Form.elShow=function(a){SPe.Form.elVisible(a,!0)};SPe.Form.elMinimize=function(a){function b(a){d.innerHTML="<a href='#'>&#187; Show the field</a>";SPe.hide(a)}var c=SPe.Form.elGetParent(a,"td"),d=document.createElement("div");c.insertBefore(d,c.firstChild);d.onclick=function(){"none"===a.style.display?(d.innerHTML="<a href='#'>&#171; Hide the field</a><br><br>",SPe.show(a)):b(a)};b(a)};SPe.Form.elRewrite=function(a,b){var c;"text"===a.type&&(c="text");"textarea"===a.type&&(c="textarea");"select-one"===a.type&&(c="select");SPe.has(a.id,"DateTimeFieldDate")&&(c="date");if(SPe.has(a.id,"ClientPeoplePicker")||SPe.has(a.className,"pickerInput"))c="user";SPe.has(a.id,"MultiChoiceTable")&&(c="checkboxes");SPe.has(a.className,"taxonomy")&&(c="taxonomy");var d="";switch(c){case "text":var e=a;d=e.value;break;case "textarea":e=a;d=SPe.Form.textGroom(e.value);break;case "select":e=a;SPe.has(e.toString(),"Select")&&(d=e.options[e.selectedIndex].text);break;case "date":e=SPe.Form.elGetParent(a,"table");d=a.value;break;case "user":e=a.parentNode;if(c=SPe.Form.elGet(e,"input","HiddenInput")){var f=JSON.parse(c.value);f.forEach(function(a){d+=", "+a.DisplayText})}else for(e=SPe.Form.elGetParent(a,"div","ReactFieldEditor-Picker"),c=SPe.Form.elGetParent(e,"div","clientFormField"),f=c.querySelectorAll("div.ms-Persona-primaryText"),c=0;c<f.length;c++)d+=", "+f[c].innerText;d=d.substring(2);break;case "checkboxes":e=a;f=e.getElementsByTagName("span");for(c=0;c<f.length;c++)SPe.has(f[c].innerHTML.toLowerCase(),"checked")&&(d+=", "+f[c].title);d=d.substring(2);break;case "taxonomy":e=a,c=SPe.Form.elGet(SPe.Form.elGetParent(e,"td"),"input","input"),d=c.value,d=d.substring(0,d.indexOf("|"))}void 0!==b&&(d=b);c=SPe.Form.elGetParent(e,"td")||SPe.Form.elGetParent(e,"div");f=c.firstChild;"span"===f.nodeName.toLowerCase()&&c.removeChild(f);SPe.hide(e);(e=SPe.Form.elGetByClass(c,"span","ms-metadata"))&&SPe.hide(e);e=document.createElement("span");SPe.has(SPe.type(c),"div")&&(e.style.padding="6px 12px 1px 12px",e.style.fontSize="14px");e.innerHTML=d;c.insertBefore(e,c.firstChild)};SPe.Form.setField=function(a,b){var c=document.createEvent("Event");c.initEvent("input",!0,!0);a.focus();a.value=b;a.dispatchEvent(c);a.blur()};SPe.Form.setPersonField=function(a,b){SPe.Form.setField(a,b);SPe.Util.wait(function(){function b(){return document.getElementById("sug-0")}a.focus();SPe.Util.when(b,function(){SPe.Form.elGetByText(b(),"button","ms-Suggestions").click();a.blur()})})};SPe.Form.preSaveTextareas=[];SPe.Form.textareaReplace=function(a,b){if(!SPe.has(SPe.Form.preSaveTextareas,a)){SPe.Form.preSaveTextareas.push(a);SPe.hide(a.parentNode);var c=SPe.Form.elGetParent(a,"td")||SPe.Form.elGetParent(a,"div","wrapper"),d=document.createElement("span"),e="string"===SPe.type(b);d.innerHTML=e?b:b.innerHTML;e||b.parentNode.removeChild(b);d=c.insertBefore(d,c.firstChild);if(a.value){if(SPe.has(d.innerHTML,"rowDuplicate"))for(c=a.value.split("\n"),d=SPe.Form.elGetByText(d,"input")||SPe.Form.elGetByText(d,"select"),e=0;e<c.length;e++)SPe.Form.rowDuplicate(d,c.length);SPe.Form.textareaValues(a)}window.PreSaveAction=window.PreSaveAction||SPe.Form.preSaveValues}};SPe.Form.textareaValues=function(a){function b(a,b){var c,d=b.split(",");for(c=0;c<d.length;c++)SPe.Form.userSet(SPe.Form.elGet(a,"div","TopSpan"),d[c],!1)}if(a.value){var c=a.value.split("\n"),d=0;a=SPe.Form.elGetParent(a,"td")||SPe.Form.elGetParent(a,"div","wrapper");a=SPe.Form.elGetByClass(a,"table");var e,f;for(e=0;e<a.rows.length;e++){var g=a.rows[e];var h=g.innerHTML;if(c[d]&&(SPe.has(h,"input")||SPe.has(h,"select"))){var l=c[d].split(";");d++;for(h=0;h<g.cells.length;h++){var k=g.cells[h];if(k=SPe.Form.elGetByText(k,"input")||SPe.Form.elGetByText(k,"select")||SPe.Form.elGetByText(k,"div"))(f="htmldivelement"===SPe.type(k))||SPe.has(k.className,"peoplepicker")?(f||(k=SPe.Form.elGetParent(k,"div")),setTimeout(b.bind(null,k,l[h]),400)):k.value=l[h]}}}}};SPe.Form.preSaveValues=function(){function a(a){var b="";a&&(JSON.parse(a).forEach(function(a){b+=","+a.EntityData.Email}),b=b.substring(1));return b}SPe.Form.preSaveTextareas.forEach(function(b){var c=SPe.Form.elGetParent(b,"td")||SPe.Form.elGetParent(b,"div","wrapper"),d="",e=SPe.Form.elGetByClass(c,"table");for(c=0;c<e.rows.length;c++){var f=e.rows[c];var g=f.innerHTML;if(SPe.has(g,"input")||SPe.has(g,"select"))for(d+="\n",g=0;g<f.cells.length;g++){var h=f.cells[g];if(h=SPe.Form.elGetByText(h,"input")||SPe.Form.elGetByText(h,"select"))h=SPe.has(h.className,"peoplepicker")?a(SPe.Form.elGet(SPe.Form.elGetParent(h,"div"),"input","HiddenInput").value):h.value.trim().replace(";",","),d+=h+";"}}if(d=d.replace(/\n;+/g,""))d=d.substring(1),SPe.Form.setField(b,d)});return!0};SPe.Form.rowDuplicate=function(a,b){b=b||5;var c=SPe.Form.elGetParent(a,"table"),d=SPe.Form.elGetParent(a,"tr");c.rows.length<=b&&(c.insertRow(-1).innerHTML=d.innerHTML)};SPe.Form.choicesGroom=function(a){a.style.width="100%";var b;for(b=0;b<a.rows.length;b++){var c=a.rows[b].cells[0].childNodes[0];var d=c.childNodes[0];c=c.childNodes[1];d.style.cssFloat="left";d.style.marginRight="5px";c.style.display="block"}};SPe.Form.optionsSave=function(a){var b=[],c;for(c=0;c<a.length;c++)a[c].value&&b.push({text:a[c].text,value:a[c].value,selected:a[c].selected});return b};SPe.Form.optionsShow=function(a,b,c){var d=SPe.Form.optionsSave(a);a.length=0;if(c){var e=document.createElement("option");e.value="";e.text="";a.add(e)}d.forEach(function(d,g){if(!b||SPe.has(b,d.value)||SPe.has(b,g))e=document.createElement("option"),e.value=d.value,e.text=d.text,a.add(e),d.selected&&!c&&(a.options[a.length-1].selected=!0)})};SPe.Form.rowsVisible=function(a,b,c){if(void 0===c||!0===c)c="";!1===c&&(c="none");b=SPe.Util.rangeToArray(b);var d;for(d=0;d<a.rows.length;d++)SPe.has(b,d)&&(a.rows[d].style.display=c)};SPe.Form.headerAdd=function(a,b,c){void 0===c&&(c=!0);a.style.marginTop="0";var d=a.insertRow(0);d.className="form-header";var e="";c&&(e="<style>.ms-dialog .form-header { display: none }</style>");c=d.insertCell(0);c.colSpan=a.rows[1].cells.length;c.style.paddingBottom="14px";c.innerHTML=e+"<div class='ms-rteFontSize-4'></div>";a=SPe.Form.elGetByClass(c,"div","ms-rteFontSize-4");b&&(a.innerHTML=b);return a};SPe.Form.rowAdd=function(a,b,c){a=SPe.Form.elGetParent(a,"tr");a=a.parentNode.insertRow(a.rowIndex).insertCell(0);a.colSpan=2;c&&(a.style.backgroundColor=c);a.innerHTML=b;return a};SPe.Form.divAdd=function(a,b,c){var d=SPe.Form.elGetParent(a,"div","ReactClientFormFields"),e=document.createElement("div");c&&(e.style.backgroundColor=c);e.innerHTML=b;d.insertBefore(e,SPe.Form.elGetParent(a,"div","clientFormField"));return e};SPe.Form.selectSet=function(a,b){var c;for(c=0;100>c;c++)if(a.options[c].value===b){a.options[c].selected=!0;break}};SPe.Form.taxonomySet=function(a,b){var c=b.Label||b.get_label(),d=b.TermGuid||b.get_termGuid(),e=SPe.Form.elGetParent(a,"td"),f=SPe.Form.elGet(e,"input","input")||SPe.Form.elGet(e,"input","ctl");SPe.Form.elGet(e,"div","editableRegion").innerHTML="<span class='valid-text' title=''>"+c+"</span>;&nbsp;<span id='ms-rterangecursor-start'></span><span id='ms-rterangecursor-end'></span>";f.value=c+"|"+d};SPe.Form.taxonomyEmpty=function(a){a=SPe.Form.elGetParent(a,"td");var b=SPe.Form.elGet(a,"input","input")||SPe.Form.elGet(a,"input","ctl");SPe.Form.elGet(a,"div","editableRegion").innerHTML="";b.value=""};SPe.Form.taxonomyMonitor=function(a,b){var c=SPe.Form.elGetParent(a,"td"),d=SPe.Form.elGet(c,"input","input")||SPe.Form.elGet(c,"input","ctl");c=SPe.Form.elGet(c,"div","editableRegion");var e=d.value;SPe.Form.elMonitor(c,function(){var a=d.value;a&&!SPe.has(a,"-0000-0000-0000-")&&a!==e&&(e=a,b(a))})};SPe.Form.textLinkify=function(a){var b="";a&&(b=a.replace(/([^"])((http|https|ftp|file):\/\/[A-Z0-9_\-+#\/.]+[A-Z0-9_\-+&@#\/%?=~|!:,;]+)/gi,"$1<a href=$2>$2</a>"),b=b.replace(/([^\/])(www\.[A-Z0-9_\-+#\/.]+[A-Z0-9_\-+&@#\/%?=~|!:,;]+)/gi,"$1<a href=http://$2>$2</a>"),b=b.replace(/([A-Z0-9_'\-.]+@[A-Z0-9_\-.]+\.[A-Z]{2,4})/gi,"<a href=mailto:$1>$1</a>"));return b};SPe.Form.textBreakify=function(a){var b="";a&&(b=a.replace(/(?:\r\n|\r|\n)/g,"<br> "));return b};SPe.Form.textBreaksClean=function(a){var b="";a&&(b=a.replace(/(<br>\s+)/gi,"<br>"),b=b.replace(/(<br><br>(<br>)+)/gi,"<br><br>"));return b};SPe.Form.textGroom=function(a){return SPe.Form.textBreaksClean(SPe.Form.textLinkify(SPe.Form.textBreakify(a)))};SPe.Form.commentsGroom=function(a,b){b=b||"border-top: 1px solid #cdcdcd";var c=SPe.Form.elGetParent(a,"td","SPFieldNote");c=(c&&c.id?"":"<div><br></div>")+a.innerHTML.replace(/<\/div>/g,"</div><div><br></div>").replace(/>\):/g,">):<div style='"+b+"'><br></div>");a.innerHTML=SPe.Form.textGroom(c)};SPe.Form.userSet=function(a,b,c){void 0===c&&(c=!0);a=SPe.Form.elGetParent(a,"td");var d=SPe.Form.elGet(a,"div","UserField");if(d){var e=d.innerHTML.toLowerCase();c&&""!==e&&"&nbsp;"!==e||(d.innerHTML=b,SPe.Form.elGet(a,"a","checkNames").click())}else if(d=SPe.Form.elGet(a,"input","HiddenInput"),!c||d&&""===d.value){SPe.Form.elGet(a,"input","EditorInput").value=b;b=window;if(!b.SPClientPeoplePicker)for(c=0;c<window.frames.length;c++)if(window.frames[c].SPClientPeoplePicker){b=window.frames[c];break}a=SPe.Form.elGet(a,"div","ClientPeoplePicker")||SPe.Form.elGet(a,"div","TopSpan");b.SPClientPeoplePicker.SPClientPeoplePickerDict[a.id].AddUnresolvedUserFromEditor(!0)}};SPe.Form.userEmpty=function(a){a=SPe.Form.elGetParent(a,"td");var b=SPe.Form.elGet(a,"div","UserField");if(b)b.innerHTML="";else{b=SPe.Form.elGet(a,"input","HiddenInput");a=SPe.Form.elGet(a,"div","ClientPeoplePicker")||SPe.Form.elGet(a,"div","TopSpan");var c=SPClientPeoplePicker.SPClientPeoplePickerDict[a.id],d=c.GetAllUserInfo();d.forEach(function(a){c.DeleteProcessedUser(d[a])});b.value=""}};SPe.Form.userMonitor=function(a,b){var c=SPe.Form.elGetParent(a,"td"),d=SPe.Form.elGet(c,"div","UserField");if(d){var e=SPe.Form.elGet(c,"input","hiddenSpanData");var f=SPe.Form.elGet(c,"span","errorLabel")}else e=SPe.Form.elGet(c,"input","HiddenInput"),d=SPe.Form.elGet(c,"div","ClientPeoplePicker");var g=function(a){var b="";if(a&&"&#160;"!==a&&!SPe.has(a,"&nbsp;")){var d;if(SPe.has(a,"spani")&&!f.innerHTML){var e=document.createElement("span");e.innerHTML=a;e=e.getElementsByTagName("span");var g;for(g=0;g<e.length;g++)(d=e[g].title)&&(b+=";"+d)}SPe.has(a,"[")&&((f=SPe.Form.elGetByClass(c,"span","errorMsg"))||JSON.parse(a).forEach(function(a){(d=SPe.Util.propertyValue(a,"Description"))&&(b+=";"+d)}));b=b.substring(1)}return b},h=g(e.value);SPe.Form.elMonitor(d,function(){var a=g(e.value);a&&a!==h&&(h=a,b(a))})};SPe.Form.dialogHandler=function(a){var b=SPe.Form.elGet(document,"div","s4-workspace");b&&(b.style.overflow="hidden");a&&a();window.SP&&SP.SOD.executeOrDelayUntilScriptLoaded(function(){var a=SP.UI.ModalDialog.get_childDialog();a&&a.autoSize()},"SP.UI.Dialog.js")};SPe.Form.dialogRefreshPage=function(a){SP.UI.ModalDialog.RefreshPage(a)};SPe.Form.paramGet=function(a){var b=document.URL,c=null;if(SPe.has(b,"?")&&SPe.has(b,a+"=")){b=b.split("?")[1].split("&");var d;for(d=0;d<b.length;d++){var e=b[d].split("=");e[0]===a&&(c=decodeURIComponent(e[1]))}}return c};SPe.Form.paramRemove=function(a){var b=document.URL,c=b;if(SPe.has(b,"?")&&SPe.has(b,a+"=")){c=b.split("?")[0];b=b.split("?")[1].split("&");var d;for(d=b.length-1;0<=d;d--){var e=b[d].split("=")[0];e===a&&b.splice(d,1)}b.length&&(c+="?"+b.join("&"))}return c};SPe.Form.preSaveFields=[];SPe.Form.elValidate=function(a){if(!SPe.has(SPe.Form.preSaveFields,a)){SPe.Form.preSaveFields.push(a);var b=SPe.Form.elGetParent(a,"tr").cells[0].childNodes[0];SPe.has(a.title,"Required")||(a.title+=" Required Field");SPe.has(b.innerHTML,"required")||(b.innerHTML+="<span title='This is a required field.' class='ms-accentText'> *</span>");window.PreSaveAction=window.PreSaveAction||SPe.Form.preSaveValidation}};SPe.Form.preSaveValidation=function(){var a=!0;SPe.Form.preSaveFields.forEach(function(b){var c=SPe.Form.elGetByClass(b.parentNode,"span","ms-formvalidation");b.value?c&&SPe.hide(c.parentNode):(c?SPe.show(c.parentNode):(c=document.createElement("span"),c.innerHTML="<span class='ms-formvalidation ms-csrformvalidation'><span role='alert'>You can't leave this blank.<br></span></span>",b.parentNode.appendChild(c)),a=!1)});return a};SPe.Form.elMonitor=function(a,b){a.addEventListener("DOMSubtreeModified",b,!1)};SPe.Form.callout=function(a){SP.SOD.registerSod("Callout.js","/_layouts/15/Callout.js");SP.SOD.loadMultiple(["Callout.js"],function(){CalloutManager.createNew(a)})};SPe.Form.datePicker=function(a){SP.SOD.registerSod("Datepicker.js","/_layouts/15/Datepicker.js");SP.SOD.loadMultiple(["Datepicker.js"],function(){var b=a+"_";document.getElementById(a).innerHTML="<table id='"+b+"TopTable' border='0' cellspacing='0' cellpadding='0'><tbody><tr><td class='ms-dtinput'><label style='display: none'>Date Picker</label><input title='Date Picker' class='ms-input' id='"+b+"' type='text' maxlength='45' value='' autopostback='0'></td><td class='ms-dtinput'><a role='button' onclick=\"clickDatePicker('"+b+"', '/_layouts/15/iframe.aspx?date=', '', event); return false;\" href='#'><img id='"+b+"DatePickerImage' alt='Select a date from the calendar.' src='/_layouts/15/images/calendar_25.gif?rev=23' border='0'></a></td><td><iframe id='"+b+"DatePickerFrame' src='/_layouts/15/iframe.aspx?date=' frameborder='0' scrolling='no' style='left: 0; top: -999px; width: 200px; height: 236px; display: none; position: absolute; z-index: 101;'></iframe></td></tr></tbody></table>"})};SPe.Form.taxonomyPicker=function(a,b,c,d){d=d||{IsMulti:!0,AllowFillIn:!1,IsSpanTermSets:!1,IsSpanTermStores:!1,IsIgnoreFormatting:!1,IsIncludeDeprecated:!1,IsIncludeUnavailable:!1,IsIncludeTermSetName:!1,IsAddTerms:!1,IsIncludePathData:!1,IsUseCommaAsDelimiter:!1,Disable:!1,ExcludeKeyword:!1,JavascriptOnValidation:"",DisplayPickerButton:!0,Lcid:1033};var e=a+"_input",f=a+"_picker";document.getElementById(a).innerHTML="<link rel='stylesheet' type='text/css' href='_layouts/15/1033/styles/WebTaggingUI.css' /><input name='"+e+"' type='hidden' id='"+e+"' /><div id='"+f+"' class='ms-taxonomy ms-taxonomy-height ms-taxonomy-width'></div>";SP.SOD.registerSod("SP.Taxonomy.js","/_layouts/15/SP.Taxonomy.js");SP.SOD.registerSod("SP.UI.Rte.js","/_layouts/15/SP.UI.Rte.js");SP.SOD.registerSod("ScriptForWebTaggingUI.js","/_layouts/15/ScriptForWebTaggingUI.js");SP.SOD.registerSod("ScriptResources.resx","/_layouts/15/ScriptResx.ashx?culture=en-us&name=ScriptResources");SP.SOD.loadMultiple(["SP.js"],function(){SP.SOD.loadMultiple(["SP.Taxonomy.js","SP.UI.Rte.js","ScriptResources.resx"],function(){var a=document.getElementById(f);a.InputFieldId=e;a.SspId=b;a.TermSetId=c;a.AnchorId="00000000-0000-0000-0000-000000000000";a.FieldName="";a.FieldId="00000000-0000-0000-0000-000000000000";a.WebServiceUrl=_spPageContextInfo.webServerRelativeUrl+"/_vti_bin/TaxonomyInternalService.json";SPe.Util.augment(a,d);SP.SOD.executeFunc("ScriptForWebTaggingUI.js","Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.taggingLoad",function(){Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.resetEventsRegistered()});SP.SOD.executeFunc("ScriptForWebTaggingUI.js","Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.onLoad",function(){Microsoft.SharePoint.Taxonomy.ScriptForWebTaggingUI.onLoad(a.id)})})})};SPe.Form.peoplePicker=function(a,b){b=b||{PrincipalAccountType:"User,DL,SecGroup,SPGroup",SearchPrincipalSource:15,ResolvePrincipalSource:15,AllowMultipleValues:!0,MaximumEntitySuggestions:50,Width:"383px"};SP.SOD.registerSod("ClientTemplates.js","/_layouts/15/ClientTemplates.js");SP.SOD.registerSod("ClientForms.js","/_layouts/15/ClientForms.js");SP.SOD.registerSod("ClientPeoplePicker.js","/_layouts/15/ClientPeoplePicker.js");SP.SOD.registerSod("AutoFill.js","/_layouts/15/AutoFill.js");SP.SOD.loadMultiple(["ClientTemplates.js","ClientForms.js","ClientPeoplePicker.js","AutoFill.js"],function(){SPClientPeoplePicker_InitStandaloneControlWrapper(a,null,b)})};SPe.Form.peoplePickerValues=function(a){var b=[],c;for(c=0;c<a.length;c++)b.push(SP.FieldUserValue.fromUser(a[c].Key));return b};SPe.Form.lookupValues=function(a){var b="";if(a){var c=[];a.length?c=a:c[0]=a;for(a=0;a<c.length;a++)b+=", "+c[a].get_lookupValue();b=b.substring(2)}return b};SPe.Form.ready=function(a){var b=window;if(!SPe.Form.get(b)){var c;for(c=0;c<window.frames.length;c++)if(SPe.Form.get(window.frames[c])){b=window.frames[c];break}}b.addEventListener("load",function(){SPe.Query.ready(a)},!1)};SPe.Form.hide=function(a){SPe.Util.when(a,function(){var b=a();SPe.hide(b)})};SPe.Form.buttonHide=function(a){SPe.Form.hide(function(){var b=SPe.Form.elGetByText(document,"i",a);b&&(b=SPe.Form.elGetParent(b,"button"));return b})};SPe.Form.observe=function(a){function b(){return document.querySelector("div.od-OverlayHost")}SPe.Util.when(b,function(){(new MutationObserver(function(b){b.forEach(function(b){SPe.has(b.target.className,"od-ListForm-topBar")&&SPe.Util.wait(function(){a()})})})).observe(b(),{attributes:!1,childList:!0,subtree:!0})})};SPe.List.listen=!0;SPe.List.customizer=function(a){SPe.List.listen&&SPe.Util.wait(function(){function b(b,c){if(SPe.has(b.innerText,c)){var f=b.getAttribute("aria-colindex");d.push(f);e[f]=a[c]}}function c(a,b){a.addEventListener("DOMCharacterDataModified",function(){b(a)})}SPe.List.listen=!1;var d=[],e={},f=document.querySelector("div.ms-DetailsHeader");if(f){f=f.querySelectorAll("div.ms-DetailsHeader-cell");var g,h;for(g=0;g<f.length;g++)for(h in a)a.hasOwnProperty(h)&&b(f[g],h)}if(h=document.querySelector("div.ms-List"))for(h=h.querySelectorAll("div.ms-DetailsRow-cell"),f=0;f<h.length;f++){g=h[f];var l=g.getAttribute("aria-colindex");SPe.has(d,l)&&(g=g.querySelector("div.od-FieldRenderer-text"),l=e[l],l(g),c(g,l))}SPe.List.listen=!0},50)};SPe.List.listener=function(a){function b(){return document.querySelector("div.od-ItemContent-list")}SPe.Util.when(b,function(){SPe.List.customizer(a);b().addEventListener("DOMNodeInserted",function(){SPe.List.customizer(a)})})};SPe.Query.ready=function(a){SP.SOD.executeOrDelayUntilScriptLoaded(a,"SP.js")};SPe.Query.failed=function(a,b){console.warn("Query failed. "+a.get_webRequest().get_url()+". "+b.get_message())};SPe.Query.context=function(){return SP.ClientContext.get_current()};SPe.Query.url=function(){return SPe.Query.context().get_url()};SPe.Query.items=function(a,b,c){var d=SPe.Query.context(),e=new SP.CamlQuery;e.set_viewXml(b);var f=d.get_web().get_lists().getByTitle(a).getItems(e);d.load(f);d.executeQueryAsync(function(){c(f)},SPe.Query.failed)};SPe.Query.succeeded=function(a,b){for(var c=a.getEnumerator(),d;c.moveNext();)d=c.get_current().get_fieldValues(),b(d)};SPe.Query.forEach=function(a,b,c){SPe.Query.items(a,b,function(a){SPe.Query.succeeded(a,c)})};SPe.Query.itemById=function(a,b,c){var d=SPe.Query.context(),e=d.get_web().get_lists().getByTitle(a).getItemById(b);d.load(e);d.executeQueryAsync(function(){c(e)},SPe.Query.failed)};SPe.Query.currentUserInit=function(a){var b=SPe.Query.context(),c=b.get_web().get_currentUser();b.load(c);b.executeQueryAsync(function(){SPe.Form.userSet(a,c.get_loginName(),!0)},SPe.Query.failed)};SPe.Query.currentUser=function(a){var b=SPe.Query.context(),c=b.get_web().get_currentUser();b.load(c);b.executeQueryAsync(function(){a(c)},SPe.Query.failed)};SPe.Query.userById=function(a,b){var c=SPe.Query.context(),d=c.get_web().get_siteUsers().getById(a);c.load(d);c.executeQueryAsync(function(){b(d)},SPe.Query.failed)};SPe.Query.userProfile=function(a,b,c){SP.SOD.registerSod("SP.UserProfiles.js","/_layouts/15/SP.UserProfiles.js");SP.SOD.registerSodDep("SP.UserProfiles.js","SP.Runtime.js");SP.SOD.loadMultiple(["SP.UserProfiles.js","SP.Runtime.js"],function(){var d=SPe.Query.context(),e=new SP.UserProfiles.PeopleManager(d);switch(a){case "user":var f=e.getPropertiesFor(b);break;case "current":f=e.getMyProperties()}d.load(f);d.executeQueryAsync(function(){c(f)},SPe.Query.failed)})};SPe.Query.userProperties=function(a,b){SPe.Query.userProfile("user",a,b)};SPe.Query.currentUserProperties=function(a){SPe.Query.userProfile("current","",a)};SPe.Query.userMembership=function(a,b){for(var c=!1,d=b.get_users().getEnumerator(),e;d.moveNext();)if(e=d.get_current(),e.get_id()===a.get_id()){c=!0;break}return c};SPe.Query.userGroup=function(a,b,c,d){var e=SPe.Query.context();switch(a){case "user":var f=e.get_web().get_siteUsers().getByLoginName(b);break;case "current":f=e.get_web().get_currentUser()}e.load(f);a=e.get_web().get_siteGroups();e.load(a);var g=a.getByName(c);e.load(g);c=g.get_users();e.load(c);e.executeQueryAsync(function(){d(SPe.Query.userMembership(f,g))},SPe.Query.failed)};SPe.Query.userInGroup=function(a,b,c){SPe.Query.userGroup("user",a,b,c)};SPe.Query.currentUserInGroup=function(a,b){SPe.Query.userGroup("current","",a,b)};SPe.Rest.digest=function(a){var b=SPe.url()+"/_api/ContextInfo";SPe.Ajax.post(b,"",SPe.Rest.headers("json"),function(b){b=JSON.parse(b);b=SPe.Util.propertyValue(b,"FormDigestValue");a(b)})};SPe.Rest.headers=function(a){var b={};if(!a||SPe.has(a,"json"))b.Accept="application/json;odata=verbose",b["Content-Type"]="application/json;odata=verbose";if(!a||SPe.has(a,"digest"))b["X-RequestDigest"]=document.getElementById("__REQUESTDIGEST").value;return b};SPe.Rest.currentUserProperties=function(a){var b=SPe.url()+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties";SPe.Rest.digest(function(c){var d=SPe.Rest.headers("json");d["X-RequestDigest"]=c;SPe.Ajax.post(b,"",d,function(b){b=JSON.parse(b);a(b)})})};SPe.Rest.createFolder=function(a,b){var c=SPe.url()+"/_api/web/Folders",d=JSON.stringify({__metadata:{type:"SP.Folder"},ServerRelativeUrl:a});SPe.Ajax.post(c,d,SPe.Rest.headers(),b)};SPe.Rest.addAttachments=function(a,b,c,d){function e(){if(c[f]){var g=c[f][0],h=c[f][1];g=g.substring(g.lastIndexOf("/"))||g;g=SPe.url()+"/_api/web/lists/getbytitle('"+a+"')/items("+b+")/AttachmentFiles/add(FileName='"+g+"')";SPe.Ajax.post(g,h,SPe.Rest.headers("digest"),function(){f++;e()})}else d()}var f=0;e()};SPe.Tabs.set=[];SPe.Tabs.add=function(a,b,c,d){d=d||function(){SPe.Form.dialogHandler()};var e=SPe.Tabs.set.push({})-1,f=SPe.Tabs.set[e],g=SPe.Form.elGetParent(a,"table","ms-formtable")||SPe.Form.elGetParent(a,"div","ReactClientFormFields");f.home=g;f.t=SPe.has(SPe.type(g),"table");f.cells=b;f.callback=d;b=f.t?{table:"border-spacing: 0 7px",td:"cursor: pointer; font-size: 110%; font-weight: bold; color: #5d5b5e; padding: 5px 20px; border-bottom: 1px solid transparent; border-top: 3px solid transparent; white-space: nowrap",bg:"#f2f2f2",color:"#508ee6",div:"width: 4px"}:{table:"border-spacing: 0 12px",td:"cursor: pointer; font-size: 100%; color: #333333; padding: 4px 18px; border-bottom: 1px solid transparent; border-top: 3px solid transparent; white-space: nowrap",bg:"#f4f4f4",color:"#0078d4",div:"width: 4px"};f.style=c||b;c=SPe.Tabs.render(e);f.t?SPe.Form.rowAdd(a,c):SPe.Form.divAdd(a,c);SPe.Tabs.listen(e);a=SPe.Form.elGet(g,"table","tabs_"+e).rows[0].cells;a[a.length-1].style.width="90%";SPe.Tabs.click(a[1])};SPe.Tabs.render=function(a){var b=SPe.Tabs.set[a],c=b.style,d="";d+="<table id='tabs_"+a+"' cellspacing='0' cellpadding='0' width='100%' style='"+c.table+"'><tbody><tr>";d+="<td style='border-bottom: 1px solid "+c.color+"'><div style='"+c.div+"'></div>";b.cells.forEach(function(b,f){d+="<td id='tab_"+(a+"-"+f)+"' style='"+c.td+"'>"+b[0]+"</td>";d+="<td style='border-bottom: 1px solid "+c.color+"'><div style='"+c.div+"'></div>"});return d+="</tr></tbody></table>"};SPe.Tabs.listen=function(a){function b(a){a.addEventListener("click",function(){SPe.Tabs.click(this)})}a="tabs_"+a;a=(document.getElementById(a)||document.getElementById("formFrame").contentWindow.document.getElementById(a)).getElementsByTagName("td");var c;for(c=0;c<a.length;c++){var d=a[c];d.id&&b(d)}};SPe.Tabs.click=function(a){var b=a.id,c=b.substring(b.indexOf("_")+1,b.indexOf("-")),d=b.substring(b.indexOf("-")+1);c=SPe.Tabs.set[c];var e=c.style.bg,f=c.style.color,g="1px solid "+f,h=SPe.Form.elGetParent(a,"table").rows[0].cells,l;for(l=0;l<h.length;l++){var k=h[l];SPe.has(k.id,"tab")&&(k.id===b?(k.style.backgroundColor="transparent",k.style.borderTopColor=f,k.style.borderLeft=g,k.style.borderRight=g,k.style.borderBottom="none"):(k.style.backgroundColor=e,k.style.borderTopColor="transparent",k.style.borderLeft="none",k.style.borderRight="none",k.style.borderBottom=g))}b=SPe.Util.rangeToArray(c.cells[d][1]);d=c.t?c.home.rows:c.home.children;for(e=0;e<d.length;e++)d[e]&&(SPe.has(b,e)?SPe.show(d[e]):SPe.hide(d[e]));c.callback(a)};SPe.Tabs.go=!0;SPe.Tabs.msgMonitor=function(a,b){a.forEach(function(a){var c=SPe.Form.elGetParent(a,"td")||SPe.Form.elGetParent(a,"div","clientFormField"),e=SPe.Form.elGetParent(a,"table")||SPe.Form.elGetParent(a,"div","ReactClientForm");SPe.Form.elMonitor(c,function(){SPe.has(c.innerHTML,"blank")&&SPe.Tabs.go&&(SPe.Tabs.go=!1,SPe.Tabs.click(SPe.Form.elGet(e,"td",b)),setTimeout(function(){SPe.Tabs.go=!0},50))})})};SPe.Task.outcome=function(a){SPe.Task.refTaskOutcome.value=a;SPe.Task.refStatus.value="Completed"};SPe.Task.groom=function(){var a=SPe.Form.get();SPe.Task.refStatus=SPe.Form.elGet(a,"select","DropDownChoice","Status");SPe.Task.refTaskOutcome=SPe.Form.elGet(a,"select","DropDownChoice","Task Outcome");if("Completed"===SPe.Task.refStatus.value){SPe.Form.elRewrite(SPe.Task.refTaskOutcome);SPe.Form.elRewrite(SPe.Task.refStatus);var b=SPe.Form.elGet(a,"textarea","TextField","Comments");b&&SPe.Form.elRewrite(b);b=a.getElementsByTagName("input");var c;for(c=0;c<b.length;c++)"button"!==b[c].type||b[c].name||SPe.hide(b[c])}else SPe.Form.elHide(SPe.Task.refTaskOutcome),SPe.Form.elHide(SPe.Task.refStatus);a=SPe.Form.elGet(a,"div","MainPanel");var d=a.parentNode;SPe.hide(d);SPe.Form.elMonitor(a,function(){var a=SPe.Form.elGet(d,"a","add_related_items");a&&SPe.hide(a.parentNode);(a=SPe.Form.elGet(d,"a","item_remove"))&&SPe.hide(a.parentNode);SPe.show(d)})};SPe.Util.augment=function(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]})};SPe.Util.round=function(a,b){void 0===b&&(b=2);return Number(Math.round(a+"e"+b)+"e-"+b)};SPe.Util.pad=function(a,b,c){b=b||2;c=c||"0";for(a=a.toString();a.length<b;)a=c+a;return a};SPe.Util.rangeToArray=function(a){var b=[];a.forEach(function(a){var c=a.toString().indexOf("-");if(-1===c)b.push(parseInt(a));else{var e=parseInt(a.substring(0,c));for(a=parseInt(a.substring(c+1));e<=a;e++)b.push(e)}});return b};SPe.Util.collectionToArray=function(a){var b=[],c;for(c=0;c<a.get_count();c++)b.push(a.itemAt(c));return b};SPe.Util.sort=function(a,b,c){var d=1,e=-1;c&&(d=-1,e=1);return a.sort(function(a,c){var f=0,g=SPe.Util.propertyValue(a,b),k=SPe.Util.propertyValue(c,b);g<k&&(f=d);g>k&&(f=e);return f})};SPe.Util.flip=function(a,b){var c={};b=b||"";Object.keys(a).forEach(function(d){c[b+a[d]]=d});return c};SPe.Util.clone=function(a){if("array"===SPe.type(a))var b=a.slice();else b={},Object.keys(a).forEach(function(c){var d=a[c];b[c]="object"===SPe.type(d)?SPe.Util.clone(d):d});return b};SPe.Util.propertyValue=function(a,b){function c(a,b){var e,f;for(e in a)if(a.hasOwnProperty(e)){var l=a[e];if("object"===SPe.type(l))null!==d||l.get_web||c(l,b);else if("array"===SPe.type(l))for(f=0;f<l.length;f++)null===d&&c(l[f],b);else if(a.Key===b||e===b){d=a.Value;void 0===d&&(d=l);break}}return d}var d=null;return c(a,b)};SPe.Util.xmlParse=function(a){a=a.replace(/&\s/g,"\uff06 ");if(window.DOMParser)var b=(new DOMParser).parseFromString(a,"text/xml");else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a);return b};SPe.Util.tagContent=function(a,b){var c=null,d=a.getElementsByTagName(b);d.length||(d=a.getElementsByTagName("d:"+b));d.length&&(c=d[0].textContent);return c};SPe.Util.xmlProperties=function(a){var b=[];a=SPe.Util.xmlParse(a).getElementsByTagName("content");var c,d,e;for(c=0;c<a.length;c++){b[c]={};var f=a[c];for(d=0;d<f.childNodes.length;d++){var g=f.childNodes[d];if(SPe.has(g.nodeName,"properties"))for(e=0;e<g.childNodes.length;e++){var h=g.childNodes[e];1===h.nodeType&&(b[c][h.localName]=h.textContent)}}}return b};SPe.Util.functionName=function(a){var b=a.name;b||(b=a.toString(),b=b.substr(9),b=b.substr(0,b.indexOf("(")).trim());return b};SPe.Util.timeout=[];SPe.Util.wait=function(a,b){b=b||191;var c=SPe.Util.functionName(a)||"no-name";clearTimeout(SPe.Util.timeout[c]);SPe.Util.timeout[c]=setTimeout(a,b)};SPe.Util.when=function(a,b){function c(){setTimeout(function(){var e=!0;if("array"===SPe.type(a)){var f,g;for(f=0;f<a.length;f++){var h=a[f].split(".");for(g=0;g<h.length;g++)var l=g?l[h[g]]:window[h[g]];if(void 0===l){e=!1;break}}}else a()||(e=!1);e?b():99>d&&(d++,c())},55)}var d=0;c()};SPe.Util["do"]=function(a){SPe.Util.when([a],function(){var b=a.split("."),c;for(c=0;c<b.length;c++)var d=c?d[b[c]]:window[b[c]];Object.defineProperty(d,"name",{value:a,writable:!1});SPe.Util.wait(d,88)})};SPe.Util.htmlDecode=function(a){var b=document.createElement("textarea");b.innerHTML=a;return b.value};SPe.Util.urlDecode=function(a){a=a.replace(/\\u002f/gi,"/");a=a.replace(/\\u0025/gi,"%");return a=a.replace(/\\u0026/gi,"&")};SPe.Util.navigateUrl=function(a){a=a.substring(a.indexOf("navigateParent(")+16);a=a.substring(0,a.indexOf(");")-1);return SPe.Util.urlDecode(a)};SPe.Util.csv=function(a,b){var c="",d;for(d=0;d<b.length;d++){var e,f=b[d],g="";for(e=0;e<f.length;e++){var h=(h=f[e])||0===h?"date"===SPe.type(h)?h.toLocaleString():h.toString():"";h=h.replace(/"/g,'""');-1<h.search(/("|,|\n)/g)&&(h='"'+h+'"');g+=","+h}e=g.substring(1)+"\n";c+=e}c=new Blob([c],{type:"text/csv;charset=utf-8"});navigator.msSaveBlob?navigator.msSaveBlob(c,a):(d=document.createElement("a"),c=URL.createObjectURL(c),d.setAttribute("href",c),d.setAttribute("download",a),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d))};SPe.Util.toTitleCase=function(a){return a.replace(/\b\w+/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})};SPe.Util.enter=function(a){document.onkeydown=function(b){b=b||window.event;13===(b.which||b.keyCode)&&a()}};SPe.Util.load=function(a){a.forEach(function(a){if(SPe.has(a.toLowerCase(),".css")){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=a;document.head.appendChild(b)}else b=document.createElement("script"),b.type="text/javascript",b.src=a,document.body.appendChild(b)})};SPe.Util.colorCode=function(a){function b(b){return SPe.has(a,b)}var c;b("Submitted")&&(c="#007497");b("Verified")&&(c="#6b399d");if(b("Approved")||b("Succeeded"))c="#249324";if(b("Rejected")||b("Failed"))c="#e60000";if(b("Returned")||b("Partially"))c="#bf0000";if(b("Completed")||b("Executed")||b("Closed"))c="#476d4c";if(b("Draft")||b("Cancelled")||b("Deferred"))c="#8c8c8c";c&&(a="<span style='color: "+c+"'>"+a+"</span>");return a}}};SPe.init()};